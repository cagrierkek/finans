<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Finans Takibi</title>
  <style>
    body { font-family: Arial; background:#f5f5f5; padding:30px; }
    input { margin:5px; padding:5px; }
    .box { background:white; padding:20px; border-radius:8px; max-width:400px; }
  </style>
</head>
<body>

<div class="box">
  <h2>Güncel Kurlar</h2>
  <div id="rates">Yükleniyor...</div>

  <h3>Varlıklar</h3>
  TL: <input id="tl" type="number" value="0"><br>
  USD: <input id="usd" type="number" value="0"><br>
  Gram Altın: <input id="gold" type="number" value="0"><br>

  <button onclick="calculate()">Hesapla</button>

  <h3 id="total"></h3>
</div>

<script>
let rates = { usd: 0, gold: 0 };

async function loadRates() {
  try {
    const res = await fetch("https://api.allorigins.win/raw?url=https://finans.truncgil.com/today.json");
    const data = await res.json();

    rates.usd = Number(data["USD"]["Satış"].replace(",", "."));
    rates.gold = Number(data["gram-altin"]["Satış"].replace(",", "."));

    document.getElementById("rates").innerText =
      `USD: ${rates.usd} TL | Gram Altın: ${rates.gold} TL`;
  } catch (e) {
    document.getElementById("rates").innerText = "Kurlar alınamadı ❌";
  }
}

function calculate() {
  const total =
    Number(tl.value) +
    Number(usd.value) * rates.usd +
    Number(gold.value) * rates.gold;

  document.getElementById("total").innerText =
    "Toplam Varlık (TL): " + total.toFixed(2);
}

loadRates();
</script>

</body>
</html>
